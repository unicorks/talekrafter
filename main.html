<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Talekrafter</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <link rel="stylesheet" href="styles.css">
    <script>
        window.addEventListener('load', function(){
        count = 0

        function download(filename, text) {
                    var element = document.createElement('a');
                    element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
                    element.setAttribute('download', filename);

                    element.style.display = 'none';
                    document.body.appendChild(element);

                    element.click();

                    document.body.removeChild(element);
                    }

            document.querySelector('#submit').addEventListener('click', () => {
                let name = document.querySelector('#name');
                let line = document.querySelector('#line');
                if (name.value !== '' && line.value !== '') {
                    // add logic to insert line in div
                    let parent = document.querySelector('#story');
                    const div = document.createElement('div');
                    arr = ['said', 'declared', 'added', 'remarked', 'mentioned']
                    const verb = arr[Math.floor(Math.random() * arr.length)];
                    div.textContent = `${name.value} ${verb}: ${line.value}`
                    div.classList.add('story_line')
                    name.value = ''
                    line.value = ''
                    parent.appendChild(div)
                    count += 1
                }
            })

            document.querySelector('#export').addEventListener('click', () => {
                if (count !== 0) {
                    let text = ""
                    let lines = document.querySelector('#story').children
                    for (i = 0; i < lines.length; i++){
                        text = text.concat(lines[i].textContent)
                    }
                    download('story.txt', text)
                }
            })

            })
    </script>

    <style>
#main {
    margin: 100px 50px;
    width:85%;
}
.story_line {
    width: 100%;
    border-radius: 2%;
    margin: 0.5%;
    padding: 0.5%;
    box-shadow: rgba(50, 50, 93, 0.25) 0px 30px 60px -12px inset, rgba(0, 0, 0, 0.3) 0px 18px 36px -18px inset;
}
.story {
    width:100%
}
button, input {
    margin: 0.5%
}
.line {
    width: 100px;
    height: 50px
}
input {
    padding: 0.375rem 0.75rem;
    font-size: 1rem;
    font-weight: 400;
    line-height: 1.5;
    border-radius: 5px;
    border-color: #5addd4;
}
input:hover {
    border-color: #15978f;
}
    </style>

</head>
<body>
    <div class="nav-main">
        <img
          id="nav-logo"
          src="tk-nobg.png"
          target="_blank"
          rel="noopener noreferrer"
        />
    </div>
<div id="main">
    <div id="subtl1">Create and collaborate on the story!</div>
    <button id="export" type="button" class="btn btn-outline-success">Export your story</button>
    <div id="story">
        <!-- dynamically add storylines -->
    </div>
    <div id="enter_line">
        <input id='name' type='text' autocomplete="off" autofocus placeholder="Enter your name..."><br>
        <input id='line' type="text" autocomplete="off" placeholder="Add a wacky, humourous line to your story...">
        <button id="submit" type="button" class="btn btn-outline-success">Submit!</button>
    </div>
</div>
</body>
</html>
